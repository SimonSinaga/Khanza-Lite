<!----------------------------
Content Area
----------------------------->
<div id="content" class="pmd-content content-area">
    <!-- Page Title for Responsive View -->
    <h1 class="h2 hide-large-desk">Pengaturan</h1>

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb pmd-breadcrumb">
            <li class="breadcrumb-item">
                <a href="{?=url(ADMIN)?}">Dashboard</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">Pengaturan</li>
        </ol>
    </nav>
    <!-- End Breadcrumb -->

    <div class="page-content">
        <div class="row">
            <div class="col-xl-8">
                <!-- Tabs -->
                <div class="pmd-tabs">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" href="#hospitalSetting" aria-controls="hospitalSetting" role="tab"
                                data-toggle="tab">Institusi</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#appSetting" aria-controls="appSetting" role="tab"
                                data-toggle="tab">Aplikasi
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#updateSetting" aria-controls="updateSetting" role="tab"
                                data-toggle="tab">Update
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="card pmd-card">
                    <div class="card-body">
                        <div class="tab-content">
                            <!-- Company Setting -->
                            <div role="tabpanel" class="tab-pane active" id="hospitalSetting">

                                <div class="d-flex justify-content-between">
                                    <h3 class="card-title pmd-title-separator">Pengaturan Institusi</h3>
                                    <a href="javascript:void(0);" title="Edit"
                                        class="btn pmd-btn-fab pmd-btn-flat btn-outline-dark pmd-ripple-effect btn-sm edit-hospital-link">
                                        <i class="material-icons">edit</i>
                                    </a>
                                </div>

                                <!-- View Hospital Details Fields -->
                                <div class="row view-hospital-fields">
                                    <div class="col-md-12 col-sm-12">
                                        <label class="title-label">Nama Institusi</label>
                                        <p>{$settings.nama_instansi}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">Email</label>
                                        <p>{$settings.email}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">No. Telepon</label>
                                        <p>{$settings.kontak}</p>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <label class="title-label">Alamat</label>
                                        <p>{$settings.alamat_instansi}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">Kabupaten/Kota</label>
                                        <p>{$settings.kabupaten}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">Propinsi</label>
                                        <p>{$settings.propinsi}</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <label class="title-label">Kode PPK</label>
                                        <p>{$settings.kode_ppk}</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <label class="title-label">Kode PPK Kemkes</label>
                                        <p>{$settings.kode_ppkkemenkes}</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <label class="title-label">Kode PPK Inhealth</label>
                                        <p>{$settings.kode_ppkinhealth}</p>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <div class="thumbnail img-fluid mb-0">
                                            <img src="{$settings.logoURL}" width="140" alt="Profile avatar">
                                        </div>
                                    </div>
                                </div>

                                <!-- Edit Hospital Details Fields -->
                                <form action="{?=url(ADMIN.'/settings/saveGeneral')?}" method="POST" enctype="multipart/form-data" class="row edit-hospital-fields" style="display:none;">
                                    <div class="col-md-12 col-sm-12">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="companyName" class="">Nama Institusi</label>
                                            <input type="text" class="form-control" id="companyName" name="nama_instansi"
                                                value="{$settings.nama_instansi}">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="email" class="">Email</label>
                                            <input type="email" class="form-control" id="email" name="email"
                                                value="{$settings.email}">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="contactNo" class="">No. Telepon</label>
                                            <input type="text" class="form-control" id="kontak" name="kontak"
                                                value="{$settings.kontak}">
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="address" class="">Alamat</label>
                                            <textarea name="alamat_instansi" class="form-control" rows="8" cols="80">{$settings.alamat_instansi}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="cityName" class="">Kabupaten/Kota</label>
                                            <input type="text" class="form-control" id="cityName" name="kabupaten"
                                                value="{$settings.kabupaten}">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="pincode" class="">Propinsi</label>
                                            <input type="text" class="form-control" id="pincode" name="propinsi"
                                                value="{$settings.propinsi}">
                                        </div>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="cityName" class="">Kode PPK</label>
                                            <input type="text" class="form-control" id="cityName" name="kode_ppk"
                                                value="{$settings.kode_ppk}">
                                        </div>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="pincode" class="">Kode PPK Kemkes</label>
                                            <input type="text" class="form-control" id="pincode" name="kode_ppkkemenkes"
                                                value="{$settings.kode_ppkkemenkes}">
                                        </div>
                                    </div>
                                    <div class="col-md-4 col-sm-4">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="pincode" class="">Kode PPK Inhealth</label>
                                            <input type="text" class="form-control" id="pincode" name="kode_ppkinhealth"
                                                value="{$settings.kode_ppkinhealth}">
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <div data-provides="fileinput" class="fileinput file-upload-140 rounded-circle profile-pic">
                                            <div data-trigger="fileinput" class="fileinput-preview thumbnail img-fluid mb-0">
                                                <img src="{$settings.logoURL}" width="140" alt="Profile avatar">
                                            </div>
                                            <div class="action-button">
                                                <span
                                                    class="btn btn-secondary pmd-btn-fab btn-xs pmd-btn-raised btn-file pmd-ripple-effect">
                                                    <span class="fileinput-new"><i class="material-icons pmd-xs">add</i></span>
                                                    <span class="fileinput-exists"><i class="material-icons pmd-xs">mode_edit</i></span>
                                                    <input type="file" name="...">
                                                </span>
                                                <a data-dismiss="fileinput"
                                                    class="btn btn-danger btn-xs pmd-btn-fab pmd-ripple-effect pmd-btn-raised btn-file fileinput-exists"
                                                    href="javascript:void(0);"><i class="material-icons pmd-xs">close</i></a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-actions">
                                        <button type="submit" name="save" class="btn pmd-btn-raised btn-primary pmd-ripple-effect mr-3">Update</button>
                                        <button class="btn btn-outline-secondary pmd-ripple-effect" id="cancel-hospital-info">Cancel</button>
                                    </div>
                                </form>

                            </div>
                            <!-- End Company Setting -->

                            <!-- APP Setting -->
                            <div role="tabpanel" class="tab-pane" id="appSetting">
                                <div class="d-flex justify-content-between">
                                    <h3 class="card-title pmd-title-separator">Pengaturan Aplikasi</h3>
                                    <a href="javascript:void(0);" title="Edit"
                                        class="btn pmd-btn-fab pmd-btn-flat btn-outline-dark pmd-ripple-effect btn-sm edit-email-link">
                                        <i class="material-icons">edit</i>
                                    </a>
                                </div>

                                <!-- View APP Settings Fields -->
                                <div class="row view-email-fields">
                                    <div class="col-md-12 col-sm-12">
                                        <label class="title-label">Halaman Depan</label>
                                        <p class="text-capitalize">{$settings_option.homepage}</p>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <label class="title-label">URL API BPJS</label>
                                        <p>{$settings_option.BpjsApiUrl}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">Cons ID BPJS</label>
                                        <p>{$settings_option.BpjsConsID}</p>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label class="title-label">Secret Key BPJS</label>
                                        <p>{$settings_option.BpjsSecretKey}</p>
                                    </div>
                                </div>

                                <!-- Edit APP Settings Fields -->
                                <form action="{?=url(ADMIN.'/settings/saveAplikasi')?}" method="POST" class="row edit-email-fields" style="display:none;">
                                    <div class="col-md-12 col-sm-12">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="emailFrom" class="">Halaman Depan</label>
                                            <select name="homepage" class="custom-select" data-use-search="true">
                                                {loop: $settings_option.pages}
                                                <option value="{$value.slug}" {if: $settings_option.homepage == $value.slug}selected{/if}>{$value.title} ({$value.slug})</option>
                                                {/loop}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-sm-12">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="emailName" class="">URL API BPJS</label>
                                            <input type="text" class="form-control" id="BpjsApiUrl" name="BpjsApiUrl"
                                                value="{$settings_option.BpjsApiUrl}">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="smtpHost" class="">Cons ID BPJS</label>
                                            <input type="text" class="form-control" id="BpjsConsID" name="BpjsConsID"
                                                value="{$settings_option.BpjsConsID}">
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <!-- Text Input Field -->
                                        <div class="form-group pmd-textfield pmd-textfield-floating-label pmd-textfield-outline">
                                            <label for="smtpPort" class="">Secret Key BPJS</label>
                                            <input type="text" class="form-control" id="BpjsSecretKey" name="BpjsSecretKey"
                                                value="{$settings_option.BpjsSecretKey}">
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-actions">
                                        <button type="submit" name="save" class="btn pmd-btn-raised btn-primary pmd-ripple-effect mr-3">Update</button>
                                        <button class="btn btn-outline-secondary pmd-ripple-effect" id="cancel-email-info">Cancel</button>
                                    </div>
                                </form>
                            </div>
                            <!-- End APP Setting -->

                            <!-- Update Setting -->
                            <div role="tabpanel" class="tab-pane" id="updateSetting">
                                <div class="d-flex justify-content-between">
                                    <h3 class="card-title pmd-title-separator">Pengaturan Update</h3>
                                </div>

                                <!-- View Update Settings Fields -->
                                <div class="row">
                                    <div class="col-md-12 col-sm-12">
                                      {if: $allow_curl==0}
                                      <div class="well well-sm clearfix" style="margin: 15px 0 15px 0;">
                                          <span class="text-danger">Tidak dapat memperbarui sistem dengan konfigurasi server saat ini. (ekstensi curl belum terpasang)</span>
                                          <span class="label label-danger pull-right">Periksa Kesalahan</span>
                                      </div>
                                      {/if}
                                      {if: isset($error)}
                                      <div class="well well-sm clearfix" style="margin: 15px 0 15px 0;">
                                          <span class="text-danger">{$error}</span>
                                          <span class="label label-danger pull-right">Sistem bermasalah</span>
                                      </div>
                                      {/if}
                                      {if: isset($request)}
                                      <div class="well well-sm clearfix" style="margin: 15px 0 15px 0;">
                                          <span class="text-info">{?=print_r($request,true)?}</span>
                                          <span class="label label-info pull-right">Debug</span>
                                      </div>
                                      {/if}
                                      <p>Pantau terus Khanza LITE anda agar selalu update dan aman!</p>
                                      <p><b>Versi:</b> {$settings.version}</p>
                                      {if: $manual_mode}
                                          <div class="well well-sm clearfix" style="margin: 15px 0 15px 0;">
                                              <span class="text-info"><b>Mode manual diaktifkan.</b> Salin versi terbaru dari Khanza LITE ke direktori utama. Sistem akan mendeteksinya secara otomatis.</span>
                                              <span class="label label-info pull-right">Info</span>
                                          </div>
                                          {if: $manual_mode['version']}
                                              <p class="alert alert-success"><b>Paket yang terdeteksi dengan versi: {$manual_mode['version']}</b></p>
                                              <form method="post">
                                                  <input type="submit" class="btn btn-primary" name="update" value="Update" />
                                              </form>
                                          {else}
                                              <p class="alert alert-danger"><b>/khanza-lite-*.zip</b> tidak terdeteksi.</p>
                                              <input type="submit" class="btn btn-primary" value="Update" disabled/>
                                          {/if}
                                      {elseif: cmpver($settings['update_version'], $settings['version']) === 1}
                                          <p class="alert alert-success">Wao...!! Versi baru tersedia ({$settings['update_version']})</p>
                                          <form method="post">
                                              <input type="submit" class="btn btn-primary" name="update" value="Update" />
                                          </form>
                                          <h3 class="mt-4">Changelog:</h3>
                                          <pre style="max-height:200px;">{$settings['update_changelog']}</pre>
                                      {elseif: isset($settings['update_version']) && cmpver($settings['update_version'], $settings['version']) === 0}
                                          <p class="alert alert-success">Bagus..! Khanza LITE yang terpasang sudah sama dengan versi update :) ({$settings['update_version']})</p>
                                          <form method="post">
                                              <input type="submit" class="btn btn-primary" name="check" value="Check Update" />
                                          </form>
                                      {elseif: isset($settings['update_version']) && cmpver($settings['update_version'], $settings['version']) === -1}
                                          <p class="alert alert-success">Waduh..! Sepertinya anda memiliki versi yang lebih baru daripada kami: D ({$settings['update_version']})</p>
                                          <form method="post">
                                              <input type="submit" class="btn btn-primary" name="check" value="Check Update" />
                                          </form>
                                      {else}
                                          <form method="post">
                                              <input type="submit" class="btn btn-primary" name="check" value="Check Update" />
                                          </form>
                                      {/if}
                                    </div>
                                </div>
                            </div>
                            <!-- End Update Setting -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4 show-large-desk">
                <div class="card pmd-card card-patients total-statisti mt-5">
                    <div class="card-header">
                      <h3 class="card-title">Informasi Sistem</h3>
                    </div>
                    <div class="card-body">
                        <img src="{?=url(THEMES.'/admin/assets/images/logo-yaski.png')?}">
                        <hr />
                        <div class="row">
                            <div class="col-6">Aplikasi</div><div class="col-6">Khanza LITE</div>
                            <div class="col-6">Versi</div><div class="col-6">{$settings.system.version}</div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="col-6">Versi PHP</div><div class="col-6">{$settings.system.php}</div>
                            <div class="col-6">Versi MySQL</div><div class="col-6">{$settings.system.mysql}</div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="col-6">Ukuran aplikasi</div><div class="col-6">{$settings.system.system_size}</div>
                            <div class="col-6">Ukuran database</div><div class="col-6">{$settings.system.mysql_size}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Content Area -->
